//----------------------
// <auto-generated>
//     Generated using Maestria.TypeProviders (https://github.com/MaestriaNet/TypeProviders)
// </auto-generated>
//----------------------

using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.IO;
using ClosedXML.Excel;
using Maestria.Extensions.FluentCast;
using Maestria.TypeProviders.Excel;



    public partial class MyExcelDataGlobalNamespace
    {
        public int Id { get; set; }
        public string Name { get; set; }
        public decimal? Value { get; set; }
        public DateTime BirthDate { get; set; }
        public int Prop { get; set; }
        public string CalculatedProp { get; set; }
        public string PropSample { get; set; }
        public string PropSample2 { get; set; }
        public string Prop_Sample3 { get; set; }
        public string Prop_Sample4 { get; set; }
        public string Prop_Sample5 { get; set; }
        public string Prop_Sample_AB { get; set; }
    }

    public static partial class MyExcelDataGlobalNamespaceFactory
    {
        public static IEnumerable<MyExcelDataGlobalNamespace> Load(Stream input, int sheetPosition = 1)
        {
            using var workbook = new XLWorkbook(input);
            return Load(workbook, sheetPosition, null);
        }

        public static IEnumerable<MyExcelDataGlobalNamespace> Load(Stream input, string sheetName)
        {
            using var workbook = new XLWorkbook(input);
            return Load(workbook, 0, sheetName);
        }

        public static IEnumerable<MyExcelDataGlobalNamespace> Load(string filePath, int sheetPosition = 1)
        {
            using var workbook = ExcelExtensions.OpenWorkbook(filePath);
            return Load(workbook, sheetPosition, null);
        }

        public static IEnumerable<MyExcelDataGlobalNamespace> Load(string filePath, string sheetName)
        {
            using var workbook = ExcelExtensions.OpenWorkbook(filePath);
            return Load(workbook, 0, sheetName);
        }

        public static IEnumerable<MyExcelDataGlobalNamespace> Load(XLWorkbook workbook, int sheetPosition = 1, string sheetName = "")
        {
            var result = new List<MyExcelDataGlobalNamespace>();
            var sheet = string.IsNullOrEmpty(sheetName) ? workbook.Worksheet(sheetPosition) : workbook.Worksheet(sheetName);
            var indexOfId = sheet.ColumnByName(@"Id");
            var indexOfName = sheet.ColumnByName(@"Name");
            var indexOfValue = sheet.ColumnByName(@"Value");
            var indexOfBirthDate = sheet.ColumnByName(@"Birth Date");
            var indexOfProp = sheet.ColumnByName(@"Prop");
            var indexOfCalculatedProp = sheet.ColumnByName(@"Calculated Prop");
            var indexOfPropSample = sheet.ColumnByName(@"Prop sample");
            var indexOfPropSample2 = sheet.ColumnByName(@"Prop-sample 2");
            var indexOfProp_Sample3 = sheet.ColumnByName(@"Prop_sample 3");
            var indexOfProp_Sample4 = sheet.ColumnByName(@"Prop\sample 4");
            var indexOfProp_Sample5 = sheet.ColumnByName(@"Prop/sample 5");
            var indexOfProp_Sample_AB = sheet.ColumnByName(@"Prop  \  sample  /  a   b");
            foreach (var row in sheet.Rows(2, sheet.RowUsedCount()))
            {
                var idValue = row.Cell(indexOfId).Value;
                var nameValue = row.Cell(indexOfName).Value;
                var valueValue = row.Cell(indexOfValue).Value;
                var birthDateValue = row.Cell(indexOfBirthDate).Value;
                var propValue = row.Cell(indexOfProp).Value;
                var calculatedPropValue = row.Cell(indexOfCalculatedProp).Value;
                var propSampleValue = row.Cell(indexOfPropSample).Value;
                var propSample2Value = row.Cell(indexOfPropSample2).Value;
                var prop_Sample3Value = row.Cell(indexOfProp_Sample3).Value;
                var prop_Sample4Value = row.Cell(indexOfProp_Sample4).Value;
                var prop_Sample5Value = row.Cell(indexOfProp_Sample5).Value;
                var prop_Sample_ABValue = row.Cell(indexOfProp_Sample_AB).Value;
                result.Add(new MyExcelDataGlobalNamespace
                {
                    Id = idValue.ToInt32(),
                    Name = nameValue.ToString(),
                    Value = valueValue.ToDecimalSafe(),
                    BirthDate = birthDateValue.ToDateTime(),
                    Prop = propValue.ToInt32(),
                    CalculatedProp = calculatedPropValue.ToString(),
                    PropSample = propSampleValue.ToString(),
                    PropSample2 = propSample2Value.ToString(),
                    Prop_Sample3 = prop_Sample3Value.ToString(),
                    Prop_Sample4 = prop_Sample4Value.ToString(),
                    Prop_Sample5 = prop_Sample5Value.ToString(),
                    Prop_Sample_AB = prop_Sample_ABValue.ToString(),
                });
            }
            return result;
        }
    }
